{% extends "base.html" %}
{% block title %}Manage Students - JNTU GV PLACEMENT CELL{% endblock %}
{% block content %}
<div class="container">
    <div class="dashboard-header">
        <h1>Manage Students</h1>
        <p>View and manage student profiles and placement statuses</p>
    </div>
    
    <div class="actions">
        <a href="{{ url_for('admin_management') }}" class="btn secondary">
            <i class="fas fa-arrow-left"></i> Back to Management
        </a>
    </div>
    
    <div class="search-filters">
        <form method="get" class="w-full">
            <div class="form-grid">
                <div class="form-group">
                    <label for="department">Department</label>
                    <select name="department" id="department" class="w-full">
                        <option value="">All Departments</option>
                        <option value="Computer Science" {% if request.args.get('department') == 'Computer Science' %}selected{% endif %}>Computer Science</option>
                        <option value="Electrical Engineering" {% if request.args.get('department') == 'Electrical Engineering' %}selected{% endif %}>Electrical Engineering</option>
                        <option value="Mechanical Engineering" {% if request.args.get('department') == 'Mechanical Engineering' %}selected{% endif %}>Mechanical Engineering</option>
                        <option value="Business Administration" {% if request.args.get('department') == 'Business Administration' %}selected{% endif %}>Business Administration</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="min_gpa">Minimum GPA</label>
                    <input type="number" name="min_gpa" id="min_gpa" step="0.01" min="0" max="10" value="{{ request.args.get('min_gpa', '') }}" class="w-full" placeholder="e.g., 7.0">
                </div>
                
                <div class="form-group">
                    <label for="skill">Skill</label>
                    <input type="text" name="skill" id="skill" value="{{ request.args.get('skill', '') }}" class="w-full" placeholder="e.g., Python">
                </div>
                
                <div class="form-group" style="align-self: flex-end;">
                    <button type="submit" class="btn primary w-full">
                        <i class="fas fa-search"></i>
                        Filter
                    </button>
                </div>
            </div>
        </form>
    </div>
    
    <div class="student-list">
        {% for student in students %}
        <div class="card student-card">
            <div class="student-header">
                <h3>{{ student.user.name }}</h3>
                <span class="status {% if student.placement_status != 'Not Placed' %}status-placed{% else %}status-not-placed{% endif %}">
                    <i class="fas fa-circle"></i>
                    {{ student.placement_status }}
                </span>
            </div>
            
            <div class="student-details">
                <div class="detail">
                    <strong>Email:</strong>
                    <span>{{ student.user.email }}</span>
                </div>
                <div class="detail">
                    <strong>Department:</strong>
                    <span>{{ student.department or 'N/A' }}</span>
                </div>
                <div class="detail">
                    <strong>GPA:</strong>
                    <span>{{ student.gpa }}</span>
                </div>
                <div class="detail">
                    <strong>Skills:</strong>
                    <span>{{ student.skills or 'N/A' }}</span>
                </div>
            </div>
            
            <div class="student-actions">
                <form method="post" action="{{ url_for('admin_update_status', student_id=student.id) }}" class="status-form">
                    <select name="placement_status" class="w-full">
                        <option value="Not Placed" {% if student.placement_status == 'Not Placed' %}selected{% endif %}>Not Placed</option>
                        <option value="Interview Scheduled" {% if student.placement_status == 'Interview Scheduled' %}selected{% endif %}>Interview Scheduled</option>
                        <option value="Offer Received" {% if student.placement_status == 'Offer Received' %}selected{% endif %}>Offer Received</option>
                        <option value="Placed" {% if student.placement_status == 'Placed' %}selected{% endif %}>Placed</option>
                    </select>
                    <button type="submit" class="btn success mt-2 w-full">
                        <i class="fas fa-sync-alt"></i>
                        Update Status
                    </button>
                </form>
                <form method="post" action="{{ url_for('admin_delete_student', student_id=student.id) }}" style="margin-top: 0.5rem;" onsubmit="return confirm('Are you sure you want to delete this student?');">
                    <button type="submit" class="btn danger w-full" style="padding: 0.5rem;">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </form>
            </div>
        </div>
        {% else %}
        <div class="card">
            <h3>No students found</h3>
            <p>Try adjusting your filters to see more results.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}